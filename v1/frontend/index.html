<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <meta name="description" content="FitnessRPG - Transformez vos entra√Ænements en aventure RPG. Gagnez de l'XP, montez en niveau et devenez le h√©ros de votre propre histoire fitness.">
  <meta name="theme-color" content="#6366f1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="FitnessRPG">

  <title>FitnessRPG - Votre Salle de Sport Gamifi√©e</title>

  <!-- Favicon -->
  <link rel="icon" type="image/x-icon" href="/assets/icons/favicon.ico">
  <link rel="apple-touch-icon" href="/assets/icons/icon-192.png">

  <!-- Manifest PWA -->
  <link rel="manifest" href="/manifest.json">

  <!-- CSS -->
  <link rel="stylesheet" href="/css/variables.css">
  <link rel="stylesheet" href="/css/reset.css">
  <link rel="stylesheet" href="/css/layout.css">
  <link rel="stylesheet" href="/css/components.css">

  <!-- Preconnect pour l'API -->
  <link rel="preconnect" href="http://localhost:5000">
</head>
<body>

  <!-- Application Container -->
  <div id="app">

    <!-- Top Navigation -->
    <header class="top-nav">
      <div class="top-nav__logo">
        <svg class="top-nav__logo-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
        </svg>
        <span>FitnessRPG</span>
      </div>

      <!-- Navigation Desktop (visible seulement sur desktop) -->
      <nav class="bottom-nav desktop-nav">
        <a href="#/" class="bottom-nav__item active" data-route="dashboard">
          <svg class="bottom-nav__icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
          </svg>
          <span class="bottom-nav__label">Accueil</span>
        </a>

        <a href="#/workout" class="bottom-nav__item" data-route="workout">
          <svg class="bottom-nav__icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
          </svg>
          <span class="bottom-nav__label">S√©ance</span>
        </a>

        <a href="#/history" class="bottom-nav__item" data-route="history">
          <svg class="bottom-nav__icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
          <span class="bottom-nav__label">Historique</span>
        </a>

        <a href="#/stats" class="bottom-nav__item" data-route="stats">
          <svg class="bottom-nav__icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
          </svg>
          <span class="bottom-nav__label">Stats</span>
        </a>
      </nav>

      <div class="top-nav__actions">
        <button class="top-nav__action" id="sync-btn" title="Synchroniser">
          <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
          </svg>
        </button>

        <button class="top-nav__action" id="profile-btn" title="Profil">
          <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
          </svg>
        </button>
      </div>
    </header>

    <!-- Main Content (pages dynamiques) -->
    <main class="main-content" id="main-content">
      <!-- Le contenu sera inject√© par le router -->
      <div class="container">
        <div style="padding: 2rem; text-align: center;">
          <div class="spinner" style="margin: 2rem auto;"></div>
          <p style="color: var(--text-secondary);">Chargement de FitnessRPG...</p>
        </div>
      </div>
    </main>

    <!-- Bottom Navigation (Mobile) -->
    <nav class="bottom-nav">
      <a href="#/" class="bottom-nav__item active" data-route="dashboard">
        <svg class="bottom-nav__icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
        </svg>
        <span class="bottom-nav__label">Accueil</span>
      </a>

      <a href="#/workout" class="bottom-nav__item" data-route="workout">
        <svg class="bottom-nav__icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
        </svg>
        <span class="bottom-nav__label">S√©ance</span>
      </a>

      <a href="#/history" class="bottom-nav__item" data-route="history">
        <svg class="bottom-nav__icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
        </svg>
        <span class="bottom-nav__label">Historique</span>
      </a>

      <a href="#/stats" class="bottom-nav__item" data-route="stats">
        <svg class="bottom-nav__icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
        </svg>
        <span class="bottom-nav__label">Stats</span>
      </a>
    </nav>

  </div>

  <!-- Toast Container (Notifications) -->
  <div class="toast-container" id="toast-container"></div>

  <!-- Modal Container (Dialogs) -->
  <div id="modal-root"></div>

  <!-- JavaScript - Chargement en ordre -->

  <!-- 1. Database -->
  <script src="/js/db/indexeddb.js"></script>
  <script src="/js/db/sync-queue.js"></script>

  <!-- 2. Utils -->
  <script src="/js/utils/constants.js"></script>
  <script src="/js/utils/helpers.js"></script>
  <script src="/js/utils/exercises-seed.js"></script>

  <!-- 3. Modules -->
  <script src="/js/modules/rpg.js"></script>
  <script src="/js/modules/workout.js"></script>
  <script src="/js/modules/smart-coach.js"></script>
  <script src="/js/modules/stats.js"></script>

  <!-- 4. UI -->
  <script src="/js/ui/components.js"></script>
  <script src="/js/ui/notifications.js"></script>
  <script src="/js/ui/timer.js"></script>

  <!-- 5. Router -->
  <script src="/js/router.js"></script>

  <!-- 6. App (Point d'entr√©e principal) -->
  <script src="/js/debug.js"></script>
  <script src="/js/app.js"></script>

  <!-- Service Worker Registration -->
  <script>
    // Enregistrer le Service Worker pour PWA
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/service-worker.js')
          .then(registration => {
            console.log('‚úÖ Service Worker enregistr√©:', registration.scope);
          })
          .catch(error => {
            console.error('‚ùå Erreur Service Worker:', error);
          });
      });
    }

    // G√©rer l'installation de la PWA
    let deferredPrompt;
    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;
      console.log('üíæ PWA pr√™te √† √™tre install√©e');

      // Afficher un bouton d'installation (peut √™tre ajout√© dans l'UI)
      window.dispatchEvent(new CustomEvent('pwa-installable'));
    });

    window.addEventListener('appinstalled', () => {
      console.log('‚úÖ PWA install√©e avec succ√®s');
      deferredPrompt = null;
    });
  </script>

</body>
</html>